@startuml
interface IRequest<T>
interface IRequestHandler<C, R>
interface IIdentityService
interface IGoogleAuthService
interface IUserManager

class UI

class AuthEndpoint {
    +GoogleLogin(command: GoogleLoginCommand): TokenDto
}

class GoogleLoginHandler {
    +Handle(command: GoogleLoginCommand): TokenDto
}
GoogleLoginHandler ..|> IRequestHandler

class GoogleLoginCommand {
    +AuthorizationCode: string
    +RedirectUri: string
}
GoogleLoginCommand ..|> IRequest

class IdentityService {
    +TryGoogleLoginAsync(code: string, redirectUri: string): TokenDto
}
IdentityService ..|> IIdentityService

class GoogleAuthService {
    +ExchangeCodeForUserInfoAsync(code: string, redirectUri: string): GoogleUserDto
}
GoogleAuthService ..|> IGoogleAuthService

class GoogleUserDto {
    +Email: string
    +Name: string
}

class UserManager {
    +FindByEmailAsync(email: string): User
    +CreateAsync(user: User): Result
}
UserManager ..|> IUserManager

class User {
    +Id: Guid
    +Email: string
    +FullName: string
    +IsDeleted: bool
    +IsBanned: bool
}

class TokenDto {
    +AccessToken: string
    +RefreshToken: string
    +ExpireMin: int
}

class Result {
    +Success: bool
    +Errors: Dictionary<string, string[]>
}

class Database

UI --> AuthEndpoint
AuthEndpoint --> GoogleLoginHandler
GoogleLoginHandler --> GoogleLoginCommand
GoogleLoginHandler --> IdentityService
IdentityService --> GoogleAuthService
IdentityService --> UserManager
UserManager --> User
UserManager --> Database
IdentityService --> TokenDto
GoogleAuthService --> GoogleUserDto
@enduml