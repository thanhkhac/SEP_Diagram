@startuml
actor User
participant "Plan Detail UI" as UI
participant PlanEndpoints
participant GetDetailPlanQueryHandler as Handler
participant ApplicationDbContext
participant Database

User -> UI : View plan details
activate UI
UI -> PlanEndpoints : GET /api/Plan/{PlanId}
activate PlanEndpoints
PlanEndpoints -> Handler : Handle(GetDetailPlanQuery)
activate Handler
Handler -> ApplicationDbContext : Query Plan by PlanId
activate ApplicationDbContext
ApplicationDbContext -> Database : Query Plan
activate Database
Database --> ApplicationDbContext : Plan
deactivate Database
ApplicationDbContext --> Handler : Plan
deactivate ApplicationDbContext
alt Plan Not Found
    Handler --> PlanEndpoints : Error: PLAN_NOT_FOUND
    PlanEndpoints --> UI : 400 Bad Request (errorCode: PLAN_NOT_FOUND)
    UI -> User : Error: Plan not found
else Plan Found
    Handler --> PlanEndpoints : PlanDetailDto
    PlanEndpoints --> UI : 200 OK (ApiResponse<PlanDetailDto>)
    UI -> User : Show plan details
end
deactivate Handler
deactivate PlanEndpoints
deactivate UI
@enduml