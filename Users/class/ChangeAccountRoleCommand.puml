@startuml

'=====================DEFINE========================

'=====================IMPORT========================
!include ../../GlobalSettings.puml
!include ../../common/Mediatr.puml
!include ../../common/IApplicationDbContext.puml
!include ../../common/EndpointClasses.puml
!include ../../common/service/IUser.puml
!include ../../common/service/IIdentityService.puml
!include ../../Domain/Constants/Roles.puml

'=====================CLASSES========================

class ChangeAccountRoleCommand {
    + UserId : Guid
    + Role : string
}

class ChangeAccountRoleCommandValidator {
    + ChangeAccountRoleCommandValidator()
}

class ChangeAccountRoleCommandHandler {
    -  _context : IApplicationDbContext
    -  _user : IUser
    -  _identityService : IIdentityService
    + ChangeAccountRoleCommandHandler(context:IApplicationDbContext, user:IUser, identityService:IIdentityService)
    +  Handle(rq:ChangeAccountRoleCommand, cancellationToken:CancellationToken) : Task<Guid>
}

'=====================ENDPOINT========================
class UserEndpoints  {
    +  ChangeAccountRole(userId:Guid, role:string, sender:ISender) : Task<Ok<ApiResponse<Guid>>>
}

'=====================RELATIONSHIP========================
ChangeAccountRoleCommand ..|> IRequest : <<implements>>
ChangeAccountRoleCommandHandler ..> ChangeAccountRoleCommand : <<uses>>
ChangeAccountRoleCommandHandler ..|> IRequestHandler : <<implements>>
UserEndpoints ..> ChangeAccountRoleCommand : <<uses>>
ChangeAccountRoleCommandHandler ..> IApplicationDbContext : <<inject>>
ChangeAccountRoleCommandHandler ..> IUser : <<inject>>
ChangeAccountRoleCommandHandler ..> IIdentityService : <<inject>>
ChangeAccountRoleCommandValidator ..> ChangeAccountRoleCommand : <<validates>>
ChangeAccountRoleCommand --> Roles : <<uses>>
!include zCommon.puml
@enduml